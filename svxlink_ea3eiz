#!/bin/bash
# script par ainstalar svxlink 15.11
while true
do
clear

echo "   ********************************************************************"
echo "   *  MENU PARA INSTALAR SVXLINK 15.11 y QTEL EN LINUX o RASPBERRY PI *"
echo "   *                           by EA3EIZ                              *"
echo "   ********************************************************************"
echo " "
echo "   1) Actualizar Dispositivo (update y upgrade)"
echo "   2) Instalar svxlink 15.11"
echo "   3) *** IMPORTANTE!! *** Este punto Ejecuta el comando ldconfig -v"
echo "   4) Editar el fichero ModuleEchoLink.conf"
echo "   5) Editar el fichero svxlink.conf"
echo "   6) Colocar autoarranque del svxlink al iniciar Linux o Raspberry pi"
echo "      Agregar: sudo svxlink justo antes de la linea exit 0"
echo " "
echo "   10)  <Para Salir>"
echo ""

echo "   Por favor, elige una opcion... 1, 2, 3, 4, 5, 6, 10" 
read escoger_menu
echo ""

case $escoger_menu in
1) echo ""

while true
do
clear

	        read -p 'Quieres actualizar Si/No: ' actualizar
		    case $actualizar in
			[sS]* ) echo ""
			echo "Estado: Actualizando >>>>>"
			sudo apt-get update
			sudo apt-get upgrade
			echo ""
			echo "Ok, se ha actualizado todo correctamente"
			echo ""
			break;;
			[nN]* ) echo ""
			break;;
			#* )	echo "Por favor elige Y o N";;
esac
done;;
2) 	echo ""

while true
do
clear
			echo ""
			echo ""
			echo ""
		    read -p 'Descargar e instalar svxlink Si/No ' installvar
			case $installvar in
			[sS]* ) echo ""
			echo "Descargando svxlink 15.11"
            wget https://github.com/sm0svx/svxlink/archive/15.11.tar.gz
			tar xzvf 15.11.tar.gz
			sudo apt-get install g++ make libsigc++-2.0-dev libgsm1-dev libpopt-dev tcl8.5-dev libgcrypt11-dev libspeex-dev libasound2-dev alsa-utils vorbis-tools  cmake libqt4-dev
			cd svxlink-15.11
			cd src	
			mkdir build
			cd build
			cmake ..
			make
			sleep 5
			sudo adduser svxlink
			sudo make install
			break;;
			[nN]* ) echo ""
			echo ""
			echo ""
			echo "volver"
			echo ""
			echo ""
			echo ""
			break;;			
esac
done;;

4) 	echo ""

while true
do
clear
			echo ""
			echo ""
			echo ""
		    read -p 'Quieres Modificar el archivo ModuleEchoLink.conf Si/No ' installvar1
			case $installvar1 in
			[sS]* ) echo ""
clear
			echo "Modificando el archivo ModuleEchoLink.conf"
      sudo nano /usr/local/etc/svxlink/svxlink.d/ModuleEchoLink.conf
      sleep 2
			break;;
			[nN]* ) echo ""
			echo ""
			echo ""
			echo "volver"
			echo ""
			echo ""
			echo ""
			break;;			
esac

done;;

5) 	echo ""

while true
do
clear
			echo ""
			echo ""
			echo ""
		    read -p 'Quieres Modificar el archivo svxlink.conf Si/No ' installvar3
			case $installvar3 in
			[sS]* ) echo ""
clear
			echo "Modificando el archivo svxlink.conf"
      sudo nano /usr/local/etc/svxlink/svxlink.conf
      sleep 2
			break;;
			[nN]* ) echo ""
			echo ""
			echo ""
			echo "volver"
			echo ""
			echo ""
			echo ""
			break;;			
esac

done;;

3) 	echo ""

while true
do
clear
			echo ""
			echo ""
			echo ""
		    read -p 'Quieres enviar el comando ldconfig -v Si/No ' installvar4
			case $installvar4 in
			[sS]* ) echo ""
clear
			echo "Modificando el archivo ldconfig -v"
                              sudo ldconfig -v
			break;;
			[nN]* ) echo ""
			echo ""
			echo ""
			echo "volver"
			echo ""
			echo ""
			echo ""
			break;;			
esac

done;;

6) 	echo ""

while true
do
clear
			echo ""
			echo ""
			echo ""
		    read -p 'Quieres que al iniciar el dispositivo, arranque el svxlink? Si/No ' installvar6
			case $installvar6 in
			[sS]* ) echo ""
clear
			echo "Colocando autoarranque en rc.local"
      sudo nano /etc/rc.local
      sleep 2
			break;;
			[nN]* ) echo ""
			echo ""
			echo ""
			echo "volver"
			echo ""
			echo ""
			echo ""
			break;;			
esac

done;;
	
10) echo ""
clear
echo "   **************************************************"
echo "   *                                                *"
echo "   *     CERRANDO SCRIPT SVXLINK 15.11 BY EA3EIZ    *"
echo "   *                                                *"
echo "   **************************************************"
sleep 3
clear
exit;;	
esac
done


